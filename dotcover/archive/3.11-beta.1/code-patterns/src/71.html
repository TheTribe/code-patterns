<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_71 = [
   [47,3,47,92,'dccv']
, [48,3,48,4,'dccv']
, [49,4,49,35,'dccv']
, [50,4,50,33,'dccv']
, [51,3,51,4,'dccv']
, [55,3,55,4,'dccv']
, [56,4,56,78,'dccv']
, [57,3,57,4,'dccv']
, [61,3,61,4,'dccv']
, [62,4,62,69,'dccv']
, [63,3,63,4,'dccv']
, [67,3,67,4,'dccv']
, [68,4,68,66,'dccv']
, [69,4,69,53,'dccv']
, [71,4,71,11,'dccv']
, [71,39,71,51,'dccv']
, [71,13,71,35,'dccv']
, [72,4,72,5,'dccv']
, [73,5,73,35,'dccv']
, [75,5,76,20,'dccv']
, [77,33,78,24,'dccv']
, [80,5,80,91,'dccv']
, [82,5,82,42,'dccv']
, [83,4,83,5,'dccv']
, [71,36,71,38,'dccv']
, [84,3,84,4,'dccv']
, [88,3,88,4,'dccv']
, [89,4,89,44,'dccv']
, [90,3,90,4,'dccv']
, [77,21,77,33,'dccv']
, [76,20,76,48,'dccv']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src71" class="dotCoverSource"><pre>#region FreeBSD

// Copyright (c) 2013, John Batte
// All rights reserved.
// 
// Redistribution and use in source and binary forms, with or without modification, are permitted provided that
// the following conditions are met:
// 
//  * Redistributions of source code must retain the above copyright notice, this list of conditions and the
//    following disclaimer.
// 
//  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
//    following disclaimer in the documentation and/or other materials provided with the distribution.
// 
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
// PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
// ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
// TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.

#endregion

using System.Linq;

using AutoMapper;

using FluentAssertions;

using Patterns.Reflection;
using Patterns.Specifications.Models;
using Patterns.Specifications.Models.Reflection;

using TechTalk.SpecFlow;
using TechTalk.SpecFlow.Assist;

namespace Patterns.Specifications.Steps.Reflection
{
	[Binding]
	public class PropertyValueSteps
	{
		private readonly ObjectContext _objectContext;
		private readonly PropertyValueContext _valueContext;

		public PropertyValueSteps(ObjectContext objectContext, PropertyValueContext valueContext)
		{
			_objectContext = objectContext;
			_valueContext = valueContext;
		}

		[Given(@&quot;my object is a test object with the following values:&quot;)]
		public void CreateTestObject(Table values)
		{
			_objectContext.Target = values.CreateInstance&lt;PropertyValueTestSubject&gt;();
		}

		[When(@&quot;I get the property values of my object&quot;)]
		public void GetPropertyValues()
		{
			_valueContext.Values = _objectContext.Target.GetPropertyValues();
		}

		[Then(@&quot;the property values should be equivalent to:&quot;)]
		public void AssertPropertyValues(Table values)
		{
			PropertyValue[] actualValues = _valueContext.Values.ToArray();
			actualValues.Length.Should().Be(values.RowCount);

			foreach (PropertyValue property in actualValues)
			{
				property.Should().NotBeNull();

				string expectedText = values.Rows
					.Where(row =&gt; row[&quot;name&quot;] == property.Name)
					.Select(row =&gt; row[&quot;value&quot;])
					.FirstOrDefault();

				object expected = Mapper.Map(expectedText, typeof (string), property.Value.GetType());

				property.Value.Should().Be(expected);
			}
		}

		[Then(@&quot;the property values should be empty&quot;)]
		public void AssertEmptyPropertyValues()
		{
			_valueContext.Values.Should().BeEmpty();
		}
	}
}</pre></code><script type="text/javascript">
			applyranges('src71', RANGES_71)
		</script>
	</body>
</html>